<!-- 상세 페이지 -->

<!DOCTYPE html>
<html lang="en">
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="css/styles.css" rel="stylesheet" />
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">

    <style>
        .center{
            display: table;
            margin-left: auto;
            margin-right: auto;
        }
    </style>
    <script src="https://code.jquery.com/jquery-3.4.1.js"></script>


</head>
<body>
<section class="content-header">
    <div class="container-fluid">
        <div class="row mb-2">
            <div class="col-sm-6" onclick="location.href='/main'">
                <h1>BookList</h1>
            </div>
            <div class="col-sm-6">
                <ol class="breadcrumb float-sm-right">
                    <li class="breadcrumb-item"><a href="/main">Home</a></li>
                    <li class="breadcrumb-item"><a href="/myReview">MyPage</a></li>
                    <li class="breadcrumb-item active"><a href="/login">LogOut</a></li>
                </ol>
            </div>
        </div>
    </div><!-- /.container-fluid -->
    <div class="center">
        <form class="form-inline ml-3" method="POST" action="/FilmSearch">
            <div class="input-group input-group-sm">
                <input class="form-control form-control-navbar" type="search" placeholder="책이름을 검색해보세요."  size="50" aria-label="Search" id="keyword" name="keyword">
                <div class="input-group-append">
                    <button class="btn btn-navbar" type="submit" color="gray">
                        검색
                    </button>
                </div>
            </div>
        </form>
    </div>
</section>

<section class="py-5">
    <div class="container px-4 px-lg-5 my-5">
        <div class="row gx-4 gx-lg-5 align-items-center" th:each="entry: ${detail}">
            <div class="col-md-6" style="width:450px; height: 600px;">
                <img class="card-img-top mb-5 mb-md-0" th:src="@{${entry.cover}}" style="width:400px; height: 600px; border: 1px solid gray" />
            </div>
            <div class="col-md-6">
                <h3 class="display-5 fw-bolder" th:text="${entry.title}"></h3>
                <div class="fs-5 mb-5">
                    <label style="font-weight: bolder;">저자 : </label>
                    <span th:text="${entry.author}" class="word"></span><br>
                    <label style="font-weight: bolder;">출간일 : </label>
                    <span th:text="${entry.pubdate}" class="word"></span><br>
                    <label style="font-weight: bolder;">정가 : </label>
                    <span th:text="${entry.pricestandard}" class="word"></span><br>
                    <label style="font-weight: bolder;">출판사</label>
                    <span th:text="${entry.publisher}" class="word"></span><br>
                    <label style="font-weight: bolder;">상품설명</label>
                    <p th:text="${entry.description}" class="lead"></p><br>
                    <div class="d-flex">
                        <input class="form-control text-center me-3" id="inputQuantity" type="num" value="1" style="max-width: 3rem" />
                        <button class="btn btn-outline-dark flex-shrink-0" type="button">
                            <i class="bi-cart-fill me-1"></i>
                            Add to cart
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <section class="mb-5">
            <div class="card bg-light">
                <div class="card-body">
                    <form class="mb-4" th:object=${reviewVO} method="post" >
                        <textarea class="form-control" rows="3" placeholder="Join the discussion and leave a comment!" th:field="*{R_CONTS}" id="R_CONTS" name="R_CONTS"></textarea>
                        <input class="btn btn-primary btn-block" id="join_button" type="submit" th:value="확인">
                    </form>
                        <div class="d-flex mb-4" th:each="entry: ${review}">
                            <div class="ms-3">
                                <div class="fw-bold" th:text="${entry.M_NICKNAME}"></div>
                                <p th:text="${entry.R_CONTS}" class="lead"></p>
                                <p th:text="${entry.R_DATE}" class="lead"></p>
                                <button class="btn btn-outline-dark flex-shrink-0" id="updateBtn" type="button" th:if="${entry.M_NO}==${member.M_NO}">수정</button>
                                <button class="btn btn-outline-dark flex-shrink-0" id="deleteBtn" type="button" th:if="${entry.M_NO}==${member.M_NO}"
                                        th:R_ID="${entry.R_NO}" th:isbn="${entry.R_BOOKKEY}" th:onclick="reviewDelete(this.getAttribute('R_ID'),this.getAttribute('isbn'))">삭제</button>
                            </div>
                        </div>
                </div>
            </div>
        </section>
    </div>
</section>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
<script src="js/scripts.js"></script>

</body>
<script>
    function reviewDelete(R_NO,isbn){
        console.log("삭제버튼")
        console.log(R_NO);
        console.log(isbn);
        $.ajax({
            type:"POST",
            url:'/detail/delete/R_NO/'+R_NO,
            success:function (res) {
                alert("삭제");
                location.href = `detail?isbn=` + isbn;
            }
        });
    }
</script>
</html>